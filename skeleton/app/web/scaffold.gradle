// ################################################################################
// Scaffolding project structure
// ################################################################################
scaffold << {
	// source packages
	def core = project.group + "." + rootProject.name + ".core" // TODO ugly dependency
	def base = project.group + "." + rootProject.name + "." + project.name


	def client = base + ".client"
	def shared = base + ".shared"
	def server = base + ".server"
	def event = client + ".event"
	def gin = client + ".gin"
	def place = client + ".place"
	def app = client + ".application"
	def ui = app + ".ui"
	def signin = app + ".signin"
	def home = app + ".home"
	def profile = app + ".profile"
	def i18n = client + ".i18n"
	def resources = client + ".resources"
	def images = resources + ".images"
	def ws = client + ".ws"
	def gatekeeper = client + ".gatekeeper"
	def util = client + ".util"
	def validation = shared + ".validation"
	def model = shared + ".model"
	def action = shared + ".action"
	def wsServer = server + ".ws"
	def handler = server + ".handler"

	new File(webAppDir.toString() + "/WEB-INF/web.xml").text = file(ext.templateBasePath + 'web.xml').text.replaceAll("@module@", rootProject.name).replaceAll("@package@", base)
	new File(webAppDir.toString() + "/index.html").text = file(ext.templateBasePath + 'index.html').text.replaceAll("@module@", rootProject.name)
	new File(webAppDir.toString() + "/sticky-footer-navbar.css").text = file(ext.templateBasePath + 'sticky-footer-navbar.css').text

	// build classname for entryPoint
	def entryPointClassName = rootProject.name.capitalize() + project.name.capitalize();
	
	def srcFolder = sourceSets.main.java.srcDirs[0].toString() + "/"
	def resourcesFolder = sourceSets.main.resources.srcDirs[0].toString() + "/"
	def testFolder = sourceSets.test.java.srcDirs[0].toString() + "/"

	// Module file (*.gwt.xml) ############################################
	new File(srcFolder + base.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + base.replaceAll("\\.", "/") + "/" + rootProject.name + ".gwt.xml").text = file(ext.templateBasePath + "/module.gwt.xml").text.replaceAll("@module@", rootProject.name).replaceAll("@base@", base)
	new File(srcFolder + base.replaceAll("\\.", "/") + "/" + rootProject.name + "Dev.gwt.xml").text = file(ext.templateBasePath + "/moduleDev.gwt.xml").text.replaceAll("@module@", rootProject.name).replaceAll("@base@", base)

	// .client ############################################################
	new File(srcFolder + client.replaceAll("\\.", "/")).mkdirs()

	// .gin ###############################################################
	new File(srcFolder + gin.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + gin.replaceAll("\\.", "/") + "/ClientModule.java").text = file(ext.templateBasePath + "/client/gin/ClientModule.java").text.replaceAll("@package@", gin).replaceAll("@base@", base)
	new File(srcFolder + gin.replaceAll("\\.", "/") + "/GinjectorExtension.java").text = file(ext.templateBasePath + "/client/gin/GinjectorExtension.java").text.replaceAll("@package@", gin).replaceAll("@base@", base)
	new File(srcFolder + gin.replaceAll("\\.", "/") + "/ResourceLoader.java").text = file(ext.templateBasePath + "/client/gin/ResourceLoader.java").text.replaceAll("@package@", gin).replaceAll("@base@", base)

	// .place #############################################################
	new File(srcFolder + place.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + place.replaceAll("\\.", "/") + "/NameTokens.java").text = file(ext.templateBasePath + "/client/place/NameTokens.java").text.replaceAll("@package@", place)

	// .application #######################################################
	new File(srcFolder + app.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + app.replaceAll("\\.", "/") + "/ApplicationPresenter.java").text = file(ext.templateBasePath + "/client/application/ApplicationPresenter.java").text.replaceAll("@package@", app).replaceAll("@base@", base)
	new File(srcFolder + app.replaceAll("\\.", "/") + "/ApplicationView.java").text = file(ext.templateBasePath + "/client/application/ApplicationView.java").text.replaceAll("@package@", app).replaceAll("@base@", base)
	new File(srcFolder + app.replaceAll("\\.", "/") + "/ApplicationView.ui.xml").text = file(ext.templateBasePath + "/client/application/ApplicationView.ui.xml").text.replaceAll("@base@", base).replaceAll("@base@", base)

	// .application.ui ####################################################
	new File(srcFolder + ui.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + ui.replaceAll("\\.", "/") + "/UiModule.java").text = file(ext.templateBasePath + "/client/application/ui/UiModule.java").text.replaceAll("@package@", ui)
	new File(srcFolder + ui.replaceAll("\\.", "/") + "/Header.java").text = file(ext.templateBasePath + "/client/application/ui/Header.java").text.replaceAll("@package@", ui).replaceAll("@base@", base)
	new File(srcFolder + ui.replaceAll("\\.", "/") + "/Header.ui.xml").text = file(ext.templateBasePath + "/client/application/ui/Header.ui.xml").text.replaceAll("@base@", base).replaceAll("@module@", rootProject.name)
	new File(srcFolder + ui.replaceAll("\\.", "/") + "/Footer.java").text = file(ext.templateBasePath + "/client/application/ui/Footer.java").text.replaceAll("@package@", ui).replaceAll("@base@", base)
	new File(srcFolder + ui.replaceAll("\\.", "/") + "/Footer.ui.xml").text = file(ext.templateBasePath + "/client/application/ui/Footer.ui.xml").text.replaceAll("@base@", base)

	// .application.signin ##################################################
	new File(srcFolder + signin.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + signin.replaceAll("\\.", "/") + "/SigninUiHandlers.java").text = file(ext.templateBasePath + "/client/application/signin/SigninUiHandlers.java").text.replaceAll("@package@", signin)
	new File(srcFolder + signin.replaceAll("\\.", "/") + "/SigninPresenter.java").text = file(ext.templateBasePath + "/client/application/signin/SigninPresenter.java").text.replaceAll("@package@", signin).replaceAll("@base@", base)
	new File(srcFolder + signin.replaceAll("\\.", "/") + "/SigninView.java").text = file(ext.templateBasePath + "/client/application/signin/SigninView.java").text.replaceAll("@package@", signin).replaceAll("@base@", base)
	new File(srcFolder + signin.replaceAll("\\.", "/") + "/SigninView.ui.xml").text = file(ext.templateBasePath + "/client/application/signin/SigninView.ui.xml").text.replaceAll("@base@", base)

	new File(testFolder + signin.replaceAll("\\.", "/")).mkdirs()
	new File(testFolder + signin.replaceAll("\\.", "/") + "/SigninPresenterTest.java").text = file(ext.templateBasePath + "/client/application/signin/SigninPresenterTest.java").text.replaceAll("@package@", signin).replaceAll("@base@", base)


	// .application.home ##################################################
	new File(srcFolder + home.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + home.replaceAll("\\.", "/") + "/HomeUiHandlers.java").text = file(ext.templateBasePath + "/client/application/home/HomeUiHandlers.java").text.replaceAll("@package@", home)
	new File(srcFolder + home.replaceAll("\\.", "/") + "/HomePresenter.java").text = file(ext.templateBasePath + "/client/application/home/HomePresenter.java").text.replaceAll("@package@", home).replaceAll("@base@", base)
	new File(srcFolder + home.replaceAll("\\.", "/") + "/HomeView.java").text = file(ext.templateBasePath + "/client/application/home/HomeView.java").text.replaceAll("@package@", home).replaceAll("@base@", base)
	new File(srcFolder + home.replaceAll("\\.", "/") + "/HomeView.ui.xml").text = file(ext.templateBasePath + "/client/application/home/HomeView.ui.xml").text.replaceAll("@base@", base)

	// .application.profile ##################################################
	new File(srcFolder + profile.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + profile.replaceAll("\\.", "/") + "/ProfileUiHandlers.java").text = file(ext.templateBasePath + "/client/application/profile/ProfileUiHandlers.java").text.replaceAll("@package@", profile)
	new File(srcFolder + profile.replaceAll("\\.", "/") + "/ProfilePresenter.java").text = file(ext.templateBasePath + "/client/application/profile/ProfilePresenter.java").text.replaceAll("@package@", profile).replaceAll("@base@", base)
	new File(srcFolder + profile.replaceAll("\\.", "/") + "/ProfileView.java").text = file(ext.templateBasePath + "/client/application/profile/ProfileView.java").text.replaceAll("@package@", profile).replaceAll("@base@", base)
	new File(srcFolder + profile.replaceAll("\\.", "/") + "/ProfileView.ui.xml").text = file(ext.templateBasePath + "/client/application/profile/ProfileView.ui.xml").text.replaceAll("@base@", base)

	// .i18n ##############################################################
	new File(srcFolder + i18n.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + i18n.replaceAll("\\.", "/") + "/AppConstants.java").text = file(ext.templateBasePath + "/client/i18n/AppConstants.java").text.replaceAll("@package@", i18n)
	new File(srcFolder + i18n.replaceAll("\\.", "/") + "/AppMessages.java").text = file(ext.templateBasePath + "/client/i18n/AppMessages.java").text.replaceAll("@package@", i18n)
	new File(srcFolder + i18n.replaceAll("\\.", "/") + "/AppConfig.java").text = file(ext.templateBasePath + "/client/i18n/AppConfig.java").text.replaceAll("@package@", i18n).replaceAll("@version@", version.toString()).replaceAll("@buildDate@", new Date().toString())

	// .resources #########################################################
	new File(srcFolder + resources.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + resources.replaceAll("\\.", "/") + "/AppResources.java").text = file(ext.templateBasePath + "/client/resources/AppResources.java").text.replaceAll("@package@", resources)

	// client.ws ##########################################################
	new File(srcFolder + ws.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + ws.replaceAll("\\.", "/") + "/BasicRestClient.java").text = file(ext.templateBasePath + "/client/ws/BasicRestClient.java").text.replaceAll("@package@", ws).replaceAll("@base@", base)
	new File(srcFolder + ws.replaceAll("\\.", "/") + "/AbstractRestCallback.java").text = file(ext.templateBasePath + "/client/ws/AbstractRestCallback.java").text.replaceAll("@package@", ws)
	new File(srcFolder + ws.replaceAll("\\.", "/") + "/HttpConstants.java").text = file(ext.templateBasePath + "/client/ws/HttpConstants.java").text.replaceAll("@package@", ws)
	new File(srcFolder + ws.replaceAll("\\.", "/") + "/AuthenticationDispatcher.java").text = file(ext.templateBasePath + "/client/ws/AuthenticationDispatcher.java").text.replaceAll("@package@", ws)

	// client.event #######################################################
	new File(srcFolder + event.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + event.replaceAll("\\.", "/") + "/LoginAuthenticated.java").text = file(ext.templateBasePath + "/client/event/LoginAuthenticated.java").text.replaceAll("@package@", event).replaceAll("@base@", base)

	// client.util ########################################################
	new File(srcFolder + util.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + util.replaceAll("\\.", "/") + "/Security.java").text = file(ext.templateBasePath + "/client/util/Security.java").text.replaceAll("@package@", util).replaceAll("@base@", base)

	// .model #############################################################
	new File(srcFolder + model.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + model.replaceAll("\\.", "/") + "/CurrentUser.java").text = file(ext.templateBasePath + "/shared/model/CurrentUser.java").text.replaceAll("@package@", model)

	// .validation ########################################################
	new File(srcFolder + validation.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + validation.replaceAll("\\.", "/") + "/FieldVerifier.java").text = file(ext.templateBasePath + "/shared/validation/FieldVerifier.java").text.replaceAll("@package@", validation)

	// .action ############################################################
	new File(srcFolder + action.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + action.replaceAll("\\.", "/") + "/Login.java").text = file(ext.templateBasePath + "/shared/action/Login.java").text.replaceAll("@package@", action)

	// .gatekeeper ########################################################
	new File(srcFolder + gatekeeper.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + gatekeeper.replaceAll("\\.", "/") + "/AbstractGatekeeper.java").text = file(ext.templateBasePath + "/client/gatekeeper/AbstractGatekeeper.java").text.replaceAll("@package@", gatekeeper).replaceAll("@shared@", shared).replaceAll("@base@", base)
	new File(srcFolder + gatekeeper.replaceAll("\\.", "/") + "/UserGatekeeper.java").text = file(ext.templateBasePath + "/client/gatekeeper/UserGatekeeper.java").text.replaceAll("@package@", gatekeeper).replaceAll("@shared@", shared).replaceAll("@base@", base)
	new File(srcFolder + gatekeeper.replaceAll("\\.", "/") + "/AdminGatekeeper.java").text = file(ext.templateBasePath + "/client/gatekeeper/AdminGatekeeper.java").text.replaceAll("@package@", gatekeeper).replaceAll("@shared@", shared).replaceAll("@base@", base)

	// .server.ws #########################################################
	new File(srcFolder + wsServer.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + wsServer.replaceAll("\\.", "/") + "/BasicRestEndpoint.java").text = file(ext.templateBasePath + "/server/ws/BasicRestEndpoint.java").text.replaceAll("@package@", wsServer).replaceAll("@base@", base)

	// .server.handler ####################################################
	new File(srcFolder + handler.replaceAll("\\.", "/")).mkdirs()
	new File(srcFolder + handler.replaceAll("\\.", "/") + "/LoginHandler.java").text = file(ext.templateBasePath + "/server/handler/LoginHandler.java").text.replaceAll("@package@", handler).replaceAll("@base@", base).replaceAll("@core@", core)
	
	
	// .resources #########################################################
	new File(resourcesFolder + resources.replaceAll("\\.", "/")).mkdirs()
	new File(resourcesFolder + resources.replaceAll("\\.", "/") + "/sprites.css").text = file(ext.templateBasePath + "/client/resources/sprites.css").text
	new File(resourcesFolder + resources.replaceAll("\\.", "/") + "/styles.css").text = file(ext.templateBasePath + "/client/resources/styles.css").text

	// .resources.images ##################################################
	new File(resourcesFolder + images.replaceAll("\\.", "/")).mkdirs()
	
}
